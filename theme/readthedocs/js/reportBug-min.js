var feedback={};function closeSendContent(){var e="not-visible";feedback.successForm.addClass(e),feedback.wrapper.addClass(e)}function sendIssue(){var e,n,t,o,s,a=new XMLHttpRequest,r=window.location.protocol+"//"+window.location.hostname+"/issue_report.php",d=feedback.textarea.val()||"",c=feedback.selectedText.text()||"",p=feedback.selectedParent.parentElement,l=feedback.username.val()||"",i="";if(p=p.parentElement,t=(o=($(p)||{}).children()||{}).index(feedback.selectedParent.parentElement),o.length>t)for(var u=0,f=(n=o.slice(0<t-3?t-3:0,t+3<=o.length?t+3:o.length)).length;u<f;u++)-1!=n[u].outerText.indexOf(c)?n[u].outerText.length>c.length?i+=n[u].outerText.replace(c,"\n```\n"+c+"\n```\n"):i+="\n```\n"+n[u].outerText+"\n```\n":i+=n[u].outerText+"\n";e=i||"```"+p.outerText+"```",s=encodeURI("comment="+d+"&selected="+c+"&page="+window.location.pathname+"&userName="+l+"&context="+e),a.open("POST",r,!0),a.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),a.send(s),feedback.textarea.val(""),feedback.gridBody.removeClass("no-scroll"),showSuccess()}function showSuccess(){var e="not-visible";feedback.successForm=$(".successText"),feedback.popupContent=$(".popup-content"),feedback.popupContent.addClass(e),feedback.successForm.removeClass(e),setTimeout(function(){closeSendContent()},3e3)}!function(s){var a,r,d,c,p,l="body";$(l).ready(function(){var n="not-visible",t="disable";function e(e){s.wrapper.hasClass(n)||((e=e||window.event).preventDefault&&e.preventDefault(),e.returnValue=!1)}function o(){this.value.trim()?s.sendBtn.removeClass(t):s.sendBtn.addClass(t)}s.body=a=$(l),s.gridBody=a.children(".wy-grid-for-nav"),s.wrapper=r=$(".wrapper-send-report"),s.popupContent=r.children(":first"),s.description=p=r.find(".popup-description"),s.textarea=s.popupContent.find(".comment"),s.note=s.popupContent.find(".rst-content"),s.selectedText=p.find(".selected .text"),s.selectedParent="",s.sendBtn=s.popupContent.find(".actions .btn"),s.successForm=s.popupContent.find(".successText"),s.username=s.popupContent.find(".name .input"),s.textarea.keyup(o).focusout(o),window.addEventListener("DOMMouseScroll",e,!1),window.onwheel=e,window.onmousewheel=document.onmousewheel=e,window.ontouchmove=e,s.body.keypress(function(e){if(e.ctrlKey&&(10==e.keyCode||13==e.keyCode)){if(!s.wrapper.hasClass(n))return;s.popupContent.removeClass(n),c=window.getSelection(),d=c.toString()||"",s.selectedParent=c.anchorNode,s.wrapper.removeClass(n),s.username.val()?s.textarea.focus():s.username.focus(),d?(s.sendBtn.removeClass(t),s.description.removeClass(n),s.selectedText.text(d),s.note.addClass(n)):(s.note.removeClass(n),s.description.addClass(n)),s.textarea.val()||s.sendBtn.addClass(t)}}),s.body.keyup(function(e){27==e.keyCode&&s.wrapper.addClass(n)}),s.body.on("click",function(e){"wrapper-send-report"==e.target.className&&!s.wrapper.hasClass(n)&&s.popupContent.hasClass(n)&&!s.successForm.hasClass(n)&&$(".wy-body-for-nav").has(e.target).length&&closeSendContent()})})}(feedback);